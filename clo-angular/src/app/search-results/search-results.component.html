<div
  class="container-fluid"
  *ngIf="(searchResults | async) as results; else loading"
  id="content"
>
  <div class="row justify-content-start orange-border-bottom">
    <h4>Search Results for "{{ searchTerm }}"</h4>
  </div>
  <ng-container *ngIf="results.data.length == 0">
    <div class="row justify-content-start pt-2">
      <span>No results found.</span>
    </div>
  </ng-container>
  <ng-container *ngIf="results.data.length > 0">
    <div class="row justify-content-between pt-2">
      <span
        >Displaying {{ start }} - {{ end }} of
        {{ results.data.length }} results.</span> 
      <ngb-pagination
        [collectionSize]="results.data.length"
        [pageSize]="pageSize"
        [maxSize]="5"
        [rotate]="true"
        [(page)]="page"
        (pageChange)="setPage($event)"
      ></ngb-pagination>
    </div>
    <div
      class="row justify-content-between align-items-center p-2 result"
      *ngFor="let result of (results.data | slice: start - 1:end)"
    >
      <!-- <div class="col-4">
        <span>Volume {{ result._id }}</span>
        <br />
        <span>Letter: </span>
        <a
          routerLink="/volume/{{ result._id }}/{{ result.letters.xml_id }}"
          routerLinkActive="active"
          >{{ result.letters.xml_id }}</a
        >
        <br />
        <span>Date: </span> {{ result.letters.docDate | date: "longDate" }}
      </div> -->
      <div class="col-8 p-0">
        <table cellpadding = "10">
          <tr>
            <td id="volResult" white-space: nowrap>
              <span>Volume: </span> {{ result._id }}
            </td>
            <td id="letterResult" white-space: nowrap>
              <span>Letter: </span>
              <a
                routerLink="/volume/{{ result._id }}/{{ result.letters.xml_id }}"
                [queryParams]="{ term: searchTerm }"
                routerLinkActive="active"
              >{{ result.letters.xml_id }}</a>
            </td>
            <td id="dateResult" white-space: nowrap>
              <span>Date: </span> {{ result.letters.docDate | date: "longDate" }}
            </td>
          </tr>
          <tr>
            <td id = "letterAuthor" white-space: nowrap>
              <span>Sender: </span> {{ result.letters.docAuthor.toUpperCase() }}
            </td>
            <td id = "letterRecipient">
              <span>Recipient: </span> {{ result.letters.recipient }}
            </td>
            <td id = "letterFootnotes">
              <span>Footnotes: </span> 
              <a
              routerLink="/volume/{{ result._id }}/{{ result.letters.xml_id }}#footnoteCollapse"
              routerLinkActive="active">
              Link to Footnotes</a>
            </td>
          </tr>
        </table>
      </div>
      <div class="col-4 p-auto" id="resultText">
        <a
          data-toggle="collapse"
          href="#{{ result.letters.xml_id }}"
          aria-expanded="false"
          [attr.aria-controls]="result.letters.xml_id"
          style="text-decoration: none;"
        >
          <span>View Letter Content</span>
          <span style="color: #5c8b57 !important;">
            <fa-icon [icon]="faPlusSquare"></fa-icon>
          </span>
        </a>
      </div>
      <div class="col-12">
        <div class="collapse" id="{{ result.letters.xml_id }}">
          <div
            class="viewer-box"
            [innerHtml]="safeHTML(result.letters.docBody)"
          ></div>
        </div>
      </div>
    </div>
    <div class="row justify-content-center pt-2">
      <ngb-pagination
        [collectionSize]="results.data.length"
        [pageSize]="pageSize"
        [maxSize]="5"
        [rotate]="true"
        [(page)]="page"
        (pageChange)="setPage($event)"
      ></ngb-pagination>
    </div>
  </ng-container>
</div>
<ng-template #loading>
  <div class="container-fluid">
    <div class="row align-items-center justify-content-center">
      <img class="loading" src="../../assets/loading.gif" />
    </div>
  </div>
</ng-template>
